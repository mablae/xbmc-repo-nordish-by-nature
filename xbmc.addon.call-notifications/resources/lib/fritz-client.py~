#!/usr/bin/python 

import telnetlib
import os
import sys
 
HOST = "fritz.box"
PORT = 1012
#ESPEAK_BINARY = "/usr/bin/espeak -v german+f2"
 
print( "Started in %s" % sys.path[0] )

tn = telnetlib.Telnet( HOST, PORT )
try:
    while True:
        event = tn.read_until( b"\n" ).decode( "utf-8" )
        edata = event.split( ';' )
        print edata 
        if edata[1] == "RING":
            caller = edata[3]
            print "Incoming call from %s" % caller

            os.system( "/usr/bin/play /usr/share/sounds/generic.wav" )
            #os.system( ESPEAK_BINARY + " \"Anruf von " + caller + ".\"" )
 
except EOFError as eof:
    print( "Connection closed by remote host." )
 
print "All done." 
